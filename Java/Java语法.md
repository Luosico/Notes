# Java语法

### HashMap

- 初始容量为16，装填因子0.75，扩容为2倍
- 底层采用数组加链表存储，`Node`（继承  `Entry`）数组，1.7之前为Entry数组
- 使用链表避免哈希冲突，当链表长度大于TREEIFY_THRESHOLD（默认为8）时，将链表转换为红黑树，当然小于UNTREEIFY_THRESHOLD（默认为6）时，又会转回链表以达到性能均衡
- JDK1.7使用头插法，JDK1.8之后使用尾插法，因为JDK1.7是用单链表进行的纵向延伸，当采用头插法就是能够提高插入的效率，但是也会容易出现逆序且环形链表死循环问题。但是在JDK1.8之后是因为加入了红黑树使用尾插法，能够避免出现逆序且链表死循环的问题。
- JDK1.7的时候使用的是数组+ 单链表的数据结构。但是在JDK1.8及之后时，使用的是数组+链表+红黑树的数据结构（当链表的深度达到8的时候，也就是默认阈值，就会自动扩容把链表转成红黑树的数据结构来把时间复杂度从O（N）变成O（logN）提高了效率）。

- 线程不安全
  - put 数据的时候
  - resize而引起死循环：自动扩容时，两个线程同时检测到需要扩容，在put()方法中调用resize()方法，同时修改一个链表会产生循环链表，接下来get()方法获取元素就会陷入死循环
- 与HashTable的区别
  - HashMap都是非synchronized的，可以接受null的key和value
  - HashTable都是synchronized的，不接受null的key和value，是线程安全的
  - HashMap不能保证随着时间推移Map中元素次序是不变的

### ArrayList

- 默认为空数组，初始容量为10，扩容为1.5倍，现在容量为当前容量和1.5倍原容量的较大值
- 底层采用Object[]数组存储
- 不是线程安全的，vector是线程安全的